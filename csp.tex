\documentclass[12pt]{article}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[pdftex,unicode]{hyperref}
\usepackage[margin=15mm,left=2cm]{geometry}
\usepackage{indentfirst}
\usepackage{amsbib}

\sloppy
\clubpenalty=999
\widowpenalty=9999

% This is all for formatting and making the Table of Contents according to 
% spec. Don't play with it.
\makeatletter
\renewcommand\l@section[2]{%
    \ifnum \c@tocdepth >\z@
        \addpenalty\@secpenalty
        \addvspace{1.0em \@plus\p@}%
        \setlength\@tempdima{1.5em}%
        \begingroup
        \parindent \z@ \rightskip \@pnumwidth
        \parfillskip -\@pnumwidth
        \leavevmode \bfseries
        \advance\leftskip\@tempdima
        \hskip -\leftskip
#1\nobreak\ 
        \leaders\hbox{$\m@th\mkern \@dotsep mu\hbox{.}\mkern \@dotsep mu$}
    \hfil \nobreak\hb@xt@\@pnumwidth{\hss #2}\par
        \endgroup
    \fi}
\makeatother

\title{Критерий планарности для класса предикатных схем}
\author{Василевская И.\,Ю.}
\date{\today}

\begin{document}
    \begin{titlepage}
        \begin{center}
            Московский Государственный Университет им. Ломоносова\\
            Факультет Вычислительной Математики и Кибернетики\\
            Кафедра Математической Кибернетики\\
            магистратура, отделение <<МММ СБИС>>\\[6cm]

            \large {Василевская Инесса Юрьевна}\\
            \LARGE \textbf {Верхние оценки одного параметра для класса предикатных схем}\\[0.8cm]
            \large \emph {Курсовая работа}\\[5.0cm]

            \begin{flushright}
                \large
                \begin{minipage}{0.40\textwidth}
                    \begin{flushleft}
                        \emph{Научный руководитель:}\\к.ф.м.н М.\,С.~Шуплецов
                    \end{flushleft}
                \end{minipage}
            \end{flushright}

            \vfill
            Москва\\
			2012
        \end{center}
    \end{titlepage}

\setcounter{page}{2}

\section{Введение}
\label{beginning}
В ряде работ (\cite{Shu09}, \cite{Shu11}) рассматривается задача синтеза для специального класса дискретных управляющих систем ~--
класса предикатных схем, который обобщает некоторые традиционные классы схем. Данные схемы строятся из предикатных элементов
и обладают рядом отличий от схем из других классов (например, направление протекания сигналов не является фиксированным).
Указанные выше работы в основном посвящены исследованию асимптотики функции Шеннона в классе предикатных схем,
 получению асимптотических оценок высокой степени точности и вопросам моделирования предикатными схемами схем из традиционных классов.

В силу особенностей класса предикатных схем, при его рассмотрении могут возникать вопросы,
нетипичные для традиционных классов. Так, к примеру, довольно любопытен вопрос функционирования предикатных схем с точки зрения оценки времени, которое нужно затратить для
вычисления конкретной схемы. 
В данной работе в качестве меры <<быстрой вычислимости>>\footnote{в англоязычной литературе употребляется термин tracktability}
 был выбран так называемый параметр \textit{ширины декомпозиции}~-- максимального числа вершин в узле дерева, 
которое можно оптимально построить по заданной предикатной схеме. Во многих работах (например, \cite{CSP10}, \cite{Gott10}, \cite{Prosc89}) было 
показано, что задачи, которые можно переформулировать в терминах Constraint Satisfaction Problem, быстро вычислимы, если ширина декомпозиции графа ограничений 
(constraint graph) ограничена сверху константой. 
Так как задача функционирования предикатных схем естественным образом представляется как задача CSP с булевыми ограничениями,
 вопрос <<быстрой вычислимости>> заданного предиката в конкретном базисе сводится к нахождению такого способа синтеза, 
 при котором результирующая схема будут иметь ограниченный параметр ширины декомпозиции
\footnote
{В англоязычных источниках известного как treewidth. В силу отсутствия общепринятого перевода, автор вводит 
понятие <<ширины декомпозиции>>}.

\section{Основные определения}
Ниже приведены формальные определения используемых в работе понятий.

\subsection{Предикатные схемы}

В настоящей работе определение предикатных схем будет дано по аналогии с \cite{Shu11}.

\textbf{Опредение}.
\textit{Схемой из предикатных элементов} или \textit{предикатной схемой в базисе $\Pi$} назовем помеченный
неориентированный двудольный граф следующей структуры:

\begin{itemize}
\item каждая вершина из первой доли помечена некоторым множеством символов из алфавита X и/или 
множеством символов из алфавита Y. 
Алфавит $X$ соответствует \textit{входным} переменным предиката, а $Y$ ~-- его внутренним переменным, 
т.е. переменным, возникающим непосредственно в процессе вычисления; 

\item каждая вершина второй доли помечена некоторым символом $\pi_i$ из множества $\Pi$ и 
соединена $k$ ребрами, пронумерованными числами $1, ..., k$, с вершинами из первой доли.
\end{itemize}

Вершины из первой доли будем называть \textit{узлами} схемы, а вершины из второй доли ~-- её \textit{предикатными элементами}. 
Узлы схемы, соединенные ребрами с предикатным элементом, будем называть полюсами этого элемента, 
а узлы, соответствующие входным переменным, ~-- полюсами схемы.
При этом считается, что узел является $j$-м полюсом предикатного элемента и соответствует 
его $j$-ой переменной, если соединяющее их ребро имеет номер $j$. Полюс схемы, которому приписано 
более одной входной переменной, называется кратным полюсом этой схемы. 

Будем считать элементарной такую предикатную схему, которая состоит либо из изолированной полюсной вершины, 
либо только из одного предикатного элемента $\pi_i$, $1 < i < k$, где $k$ ~-- число полюсов указанного элемента.

В тех случаях, когда это не вызывает разночтений, 
не будем различать узел схемы и переменную, 
символ которой приписан данной вершине, а также предикатный элемент и сам предикат, отвечающий этому элементу. 
Также, для удобства, в некоторых случаях будем использовать упрощенное описание предикатной схемы, 
опуская пометки дуг и некоторых внутренних вершин. 

\subsection{Функционирование предикатных схем}
\label{func}
Функционирование предикатного элемента с $k$ полюсами задается его характеристической функцией от $k$ переменных, 
связанных с указанными полюсами, и определяется тем, что предикатный элемент находится в допустимом состоянии на тех и 
только тех наборах значений этих переменных, на которых данная функция равна 1. 

Предикатная схема $\Sigma$ находится в допустимом состоянии на заданном наборе значений её полюсных переменных тогда и только тогда, 
когда существует такой набор значений внутренних переменных схемы, на котором все предикатные элементы схемы находятся в допустимых состояниях. 
Если же указанного набора значений внутренних переменных не существует, то считается, что схема находится в недопустимом состоянии на 
заданном наборе значений её полюсных переменных.

Предполагается, что предикатная схема $\Sigma$ реализует предикат $\pi$ от её полюсных переменных, если множество допустимых наборов $\pi$ 
совпадает с множеством тех наборов, на которых $\Sigma$ находится в допустимом состоянии. 
При этом схемы будем называть эквивалентными, если они реализуют равные предикаты. 
Отметим, что элементарная предикатная схема, состоящая из изолированной полюсной вершины, реализует тождественно истинный предикат.
 Будем считать также, что тождественно истинный (соответственно тождественно ложный)
 предикат реализуется любой предикатной схемой без входных полюсов, 
которая имеет непустое (соответственно пустое) множество допустимых состояний.

В общем случае граф предикатной схемы может содержать несколько компонент связности. 
В дальнейшем, будем считать, что схема не содержит компонент связности, 
которые не имеют полюсных узлов и для которых существует хотя бы один допустимый набор, так как такие компоненты не влияют на функционирование схемы.

Суперпозицией двух предикатных схем, не имеющих общих вершин и пометок, 
будем называть их объединение с возможным отождествлением группы полюсов этих схем, 
которое сопровождается приписыванием новой (``объединенной'') вершине либо 
некоторого подмножества переменных данной группы, либо ``новой'' внутренней переменной.
 При этом частными случаями суперпозиции являются следующие операции:
\begin{itemize}
\item переименование полюсной переменной схемы

\item введение фиктивной полюсной переменной схемы

\item проекция или снятие полюсной переменной схемы

\item отождествление двух полюсных переменных схемы
\end{itemize}

Дадим более полное определение операциям над предикатами.
Обозначим $\pi(x_1, \dots, x_n)$~-- сам предикат, $\Pi(x_1, \dots, x_n)$ ~-- множество его кортежей (наборов значений).

Множество всех возможных кортежей в домене $D=[0,1]$ предиката $\pi(x_1, \dots, x_n)$ будем обозначать $P_2^n$. 
\begin{itemize}
\item Операция вертикальной выборки $SELECT$:
$\pi(x_1, \dots, x_n) SELECT X=\{x_1=\alpha_1, \ldots, x_k=\alpha_k\} \Longrightarrow$
$\pi(\alpha_1, \dots, \alpha_k, x_{k+1}, \dots, x_n)$
Эквивалентное определение: $\exists x_{k+1}, \dots, x_n: \pi(\alpha_1, \dots, \alpha_k, x_{k+1}, \dots, x_n)$. 
В описании модели в статье (Боднарчука? Уточнить!) это частный случай операции суперпозиции~-- операция подстановки констант.
\item Операция отождествления входов~-- частный случай операции $SELECT$: $SELECT X=\{x_1=x_2=\dots=x_k\}$
\item Операция горизонтальной выборки $PROJECT$:
$\pi(x_1, \dots, x_n)$ PROJECT $X=\{x_1, \dots, x_k\} \Longrightarrow \pi(x_k+1, \dots, x_n)$
В описании модели в статье (Боднарчука? Уточнить!) это операция проекции.
\item Операция декартового произведения CARTESIAN $(\otimes)$:
$\pi_1(x_1, \dots, x_n)$ CARTESIAN $\pi_2(y_1, \dots, y_m) \Longrightarrow \pi(x_1, \dots, x_n, y_1, \dots, y_m)$
$\Pi = \Pi_1 \otimes\Pi_2$.
Эквивалентное определение: $\exists x_1, \dots, x_n, y_1, \dots, y_n: \pi_1(x_{1}, \dots, x_n)$
$\& \pi_2(y_1, \dots, y_m)$
В описании модели в статье (Боднарчука? Уточнить!) это операция конъюнкции.
\item Операция отождествления $JOIN_k$ по $k$ переменным:
$\pi_1(x_1, \dots, x_n) JOIN_k \pi_2(y_1, \dots, y_m) = \pi_1(x_1, \dots, x_k, x_{k+1}, \dots, x_n)$
$SELECT X=\{\Pi_1(x_1, \dots, x_k) \bigcap \Pi_2(x_1, \dots, x_k)\}$ CARTESIAN $\pi_2(x_1, \dots, x_k, x_{k+1}, \dots, x_m)$
$SELECT X=\{\Pi_1(x_2, \dots, x_k) \bigcap  \Pi_2(x_1, \dots, x_k)\}$ 
Эквивалентное определение: $\exists x_1, \dots, x_n, y_1, \dots, y_m: \pi_1(x_{1}, \dots, x_k, x_{k+1}, \dots, x_n)$
$\& \pi_2(x_1, \dots, x_k, y_{k+1}, \dots, y_m)$
В описании модели в статье (Боднарчука? Уточнить!) это операция конъюнкции.
\item Для удобства расширим набор доступных операций операцией NEGATE: 
$\pi NEGATE X=\{x_1, \dots, x_k\} = \pi_1 JOIN_1 on x_1 JOIN \pi_2 on x_2 \dots JOIN \pi_k on x_k$, где 
$\Pi_i = \{ (01), (10) \}$
\end{itemize}
%Наглядно операция $JOIN_1$ рассмотрена на рис. \ref{fig:join}
%\begin{figure}[htb]
%\centering
%\includegraphics[width=1.0\textwidth]{join.png}
%\caption{Определение операции $JOIN_1$}
%\label{fig:join}
%\end{figure}

\subsection{Шефферов базис}

\textbf{Определение} ФАЛ
$f (x_1, \ldots, x_n)$ от $n$ переменных сохраняет предикат $ (x_1, \ldots, x_m)$ от $m$
переменных тогда и только тогда, когда для любых $n$ допустимых наборов $\alpha^i = (\alpha_1^i, \ldots, \alpha_n^i), 
i = \overline{1, n}$ значений переменных предиката $\pi$ набор
значений $( f(\alpha_1^1, \ldots, \alpha_1^n), \ldots, f(\alpha_m^1, \ldots, \alpha_m^n) )$
тоже является допустимым для предиката $\pi$.

По аналогии с \cite{Shu11} определим следующие классы:
\begin{itemize}
    \item{$T_0$}~-- множество всех предикатов, сохраняющих константную ФАЛ 0.
    \item{$T_1$}~-- множество всех предикатов, сохраняющих константную ФАЛ 1.
    \item{S}~-- множество всех предикатов, сохраняющих ФАЛ $\bar{x}$.
    \item{K}~-- множество всех предикатов, сохраняющих все конъюнкции от двух и более переменных.
    \item{D}~-- множество всех предикатов, сохраняющих все дизъюнкции от двух и более переменных.
    \item{SM}~-- множество всех предикатов, сохраняющих все монотонные самодвойственные ФАЛ.
    \item{SL}~-- множество всех предикатов, сохраняющих все монотонные линейные ФАЛ.
\end{itemize}

\textbf{Теорема (Критерий полноты для предикатных схем)}. Система из $B$ предикатов является полной $\iff$
она не лежит целиком ни в одном из 7 предполных классов: $T_0, T_1, SM, SL, S, K, D$. \cite{Shu11} 

\textbf{Замечание 1.} Если P~-- предполный класс, то P замкнут относительно операций SELECT, JOIN, PROJECT.
\textbf{Замечание 2.} Если $P$ ~-- предполный класс, $P \neq SM$, то $P$ не замкнут
относительно операции NEGATE\footnote{Например, $P = K$}.
Однако, $P = SM$ замкнут относительно операции NEGATE.

\textbf{Определение} Шефферовым базисом будем называть полный базис, состоящий из одного предиката. Сам этот предикат
будем называть шефферовым предикатом.

\textbf{Определение} Минимальным предикатом $\pi_{min}(x_1, \dots, x_n) \notin P$, где $P$~-- один из предполных классов, будем называть такой 
предикат $\pi$, что $\forall \pi(x_{i_1}, \dots, x_{i_{n-1}})$, полученный из $\pi_{min}$ проекцией по одной из переменных
предиката, принадлежит $P$.

\textbf{Определение} Минимальный шефферов предикат от n переменных будем обозначать $Sch_{min}^n(x_1, \dots, x_n)$.

Шефферов предикат от n переменных, содержащий k кортежей, будем обозначать $Sch_k^n$.

\textbf{Определение}
Рассмотрим предикат 
$\pi, \Pi = \{ (\alpha, \bar{\alpha}, \dots, \bar{\alpha}), (\bar{\alpha}, \alpha, \dots, \bar{\alpha}), \dots, $
$(\bar{\alpha}, \bar{\alpha}, \dots, \alpha) \}$. Нетрудно видеть, что $\pi = Sch_n^n$. В дальнейшем,
шефферовы предикаты, множество кортежей которых обладает такой структурой, будем называть 
симметричными шефферовыми предикатами порядка n и обозначать $Sch_{symm}^n$
%Перебором можно убедиться, что множество всех шефферовых предикатов от не более чем трех переменных\footnote{
%заметим, что в силу принадлежности всех предикатов двух переменных классу SM, шефферов предикат не может зависеть
%менее чем от 3 переменных}, 
%разбивается на три класса эквивалентности относительно операции
%перестановки переменных и взятия отрицания одной или нескольких переменных. 

\begin{figure}[htb]
\centering
\includegraphics[width=0.5\textwidth]{scheff3.png}
\caption{Шефферовы предикаты от 3 переменных}
\label{fig:sheff}
\end{figure}


\subsection{Планарность}
\textbf{Определение.} 
Предикатная схема, которую можно уложить на плоскости без реберных пересечений таким образом, что
все полюса предикатов лежат на внешней границе, называется планарной. 

\textbf{Определение.} Базис называется планарным, если в нем можно реализовать любой предикат планарной схемой.

Заметим, что операции $JOIN_2$ (отождествление не более чем по двум переменным), PROJECT, SELECT и NEGATE 
сохраняют планарность. В дальнейшем операции над предикатными элементами, сохраняющие планарность схемы,
будем называть операциями планарной суперпозиции.

Покажем, что, применяя над полным базисом $B$ только операции планарной суперпозиции PROJECT, SELECT, $JOIN_2$,
можно получить предикаты-константы
$\pi_0(x_1), \Pi_0=(0)$ и $\pi_1(x_1), \Pi_1=(1)$ и предикат-отрицание $\pi_{neg}(x_1, x_2), \Pi_{neg}=( (01), (10) )$.

\subsubsection{Получение констант}
\textbf{Лемма} Пусть дан полный базис B. Покажем, что из B, применением операции отождествления входов,
можно получить константу.

\textbf{Доказательство} $\exists \pi \in B, \pi \notin S \Rightarrow \exists \alpha_1 \in \Pi, \bar{\alpha_1} \notin \Pi$
Отождествляя все переменные, равные 0, и все переменные, равные 1, получаем одну из констант.
Если получили константу 0, то берем $\pi_1 \notin T_0 \Rightarrow \forall \beta_1 \in \Pi_1, \beta_1=(0 \ldots 0)$. 
Подставляем вместе определенных переменных 0, получаем константу 1. 
В случае константы 1, поступаем аналогично.
\begin{figure}[htb]
\centering
\includegraphics[width=0.01\textwidth]{3_2to3.png}
\caption{Получение константы}
\label{fig:constant}
\end{figure}

\subsubsection{Получение отрицания}
\textbf{Лемма}
Пусть дан полный базис B. Покажем, что из B, применением операций $JOIN_2$, SELECT, PROJECT можно получить отрицание.

\textbf{Доказательство} $\exists \pi \in B, \pi \notin K \Rightarrow \exists \alpha_1, \alpha_2 \in \Pi$,
$\alpha_1\&\alpha_2=\beta, \beta \notin \Pi$, причем эти наборы должны отличаться как минимум по двум переменным $x_i, x_{j}$.
Таким образом, подставив вместо всех общих переменных этих наборов соответствующие константы 0 и 1, применив операцию PROJECT
(чтобы оставить в точности две необходимых для сохранения свойства $\pi \notin K$ переменных $x_i, x_j$), 
получим предикат-отрицание $\pi_{neg}, \Pi_{neg} = \{ (01), (10) \} $.
\begin{figure}[htb]
\centering
\includegraphics[width=0.01\textwidth]{3_2to3.png}
\caption{Получение отрицания $\pi_{neg}$}
\label{fig:negation}
\end{figure}

\label{planar_basis}
\textbf{Утверждение 1.} Шефферовы базисы на рис. \ref{fig:sheff} являются планарными.

\textbf{Доказательство.} Пусть дана предикатная схема $\Sigma$, граф которой, при укладке на плоскость, содержит
реберные пересечения. Так как в базисе $B=\{\pi_{Sch_3}\}$, $\Pi_{Sch_3} = \{ (001), (010), (100) \}$
\label{eq:basis} можно планарной схемой реализовать предикат 
$\pi_{linear}, \Pi_{linear} = \{ (001), (010), (100), (111) \}$, то замещая каждое реберное пересечение в схеме на 
3 предиката ($\pi_{linear}$) по схеме \ref{fig:xor}, получаем планарную реализацию требуемого предиката
в базисе \ref{eq:basis}.

\textbf{Замечание.} При преобразовании непланарной схемы в базисе $B=\{\pi_{Sch_3}\}$
по вышеописанному алгоритму, сложность схемы в смысле количества предикатов возрастает на $3*k$, где $k$~-- число реберных
пересечений графа предикатной схемы.

%Базис $((001), (010), (100), (011))$ сводится к базису \ref{eq:basis} как показано на рисунке 
%\ref{fig:scheff3_4}\footnote{Белыми кружками помечены полюса предиката}.
%Базис $((001), (010), (100), (011), (101))$ сводится к базису \ref{eq:basis} как показано на рисунке \ref{fig:scheff3_5}

\begin{figure}[htb]
\centering
\includegraphics[width=0.5\textwidth]{intersection.png}
\caption{Получение планарной схемы}
\label{fig:xor}
\end{figure}


\begin{figure}[htb]
\centering
\includegraphics[width=0.4\textwidth]{scheff4.png}
\caption{Сведение $Sch_4^3$ к $Sch_{symm}^3$}
\label{fig:scheff3_4}
\end{figure}


\begin{figure}[htb]
\centering
\includegraphics[width=0.7\textwidth]{scheff5.png}
\caption{Сведение $Sch_5^3$ к $Sch_{symm}^3$}
\label{fig:scheff3_5}
\end{figure}


%\textbf{Лемма.} Система из $\{\pi_1 \notin SM, \pi_{neq}, \Pi_neq = \{ (01), (10) \}\}$ полна.
%\textbf{Доказательство.} 

\label{eq:lemma_sm}
\textbf{Лемма.} Если $\pi \notin SM$, то, применяя операции PROJECT и NEGATE,
можно получить $\pi_{min} \notin SM$, причем $\Pi_{min}$ будет содержать симметричный Шефферов предикат.

\textbf{Доказательство.} Рассмотрим $\pi_{min} \notin SM$ такой, что $\forall i, \pi_1 = \pi_{min} PROJECT x_i$, $\pi_1 \in SM$.
Пусть $\beta = (\beta_1, \dots, \beta_k)$~-- набор, $\notin \pi_{min}$, полученный в результате применения какой-то несамодвойственной функции.
Заметим, что $\beta \neq \forall \alpha \in \pi$. Однако, для соблюдения верхнего условия, $\Pi_{min}$ должно содержать наборы 
$(\bar{\beta_1}, \beta_2, \dots, \beta_k), (\beta_1, \bar{\beta_2}, \dots, \beta_k), \dots, (\beta_1, \beta_2, \dots, \bar{\beta_k})$.

Так как класс $SM$ замкнут относительно операции NEGATE, применяя эту операцию к $\pi_{min}$ можно получить $\pi_{min}^1$,
$\pi_{min}^1$ не содержит набор $\beta^1 = (\sigma, \sigma, \dots, \sigma)$. 
Нетрудно видеть, 
что в таком случае $\Pi_{min}^1$ содержит в точности симметричный Шефферов предикат.

\textbf{Следствие.} $\pi \notin SM \Longrightarrow \exists \pi_{min} \notin SM, \alpha = (\sigma, \sigma, \dots, \sigma) \notin \Pi_{min}, \sigma \in \{0, 1\}$.

\textbf{Лемма.} Если $\pi(x_1, \dots, x_n) = Sch_{symm}^n, n > 3$, то, применяя операции подстановки констант и PROJECT, можно
получить $\pi_1 = Sch_{symm}^{n-1}$.

\textbf{Доказательство.} Так как 
$\pi \notin SM, \exists \widetilde{\alpha} = (\alpha, \dots, \alpha)$, $\pi$ не сохраняет $\widetilde{\alpha}$.
Тогда 
$\pi_1 = ( (\pi SELECT x_1=\alpha)  PROJECT  x_1 )$, где $\pi_1(x_1, \dots, x_{n-1}) = Sch_{symm}^{n-1}$

\label{eq:svedenie}
\textbf{Лемма.} Если $\pi(x_1, \dots, x_n) \notin SM, n > 3$, то, применяя операции подстановки констант, NEGATE и PROJECT,
можно получить $\pi_1(x_1, \dots, x_{n-1}) \notin SM$.

\textbf{Доказательство.} По следствию из \ref{eq:lemma_sm}, 
$\exists \pi_{min} \notin SM, \alpha=(\sigma, \dots, \sigma) \notin \Pi_{min}$. Тогда предикат $\pi_1$, такой что
$\pi_1 = ( (\pi_{min} SELECT x_1=\sigma) PROJECT x_1 )$, не принадлежит $SM$, и зависит от $n-1$ переменной.

%\label{eq:3tuples}
%\textbf{Следствие.} Пусть $\pi(x_1, x_2, x_3) \notin SM$. 
%Тогда : $\pi_1 = (((\pi SELECT x_1=\bar{\alpha}) PROJECT x_1)$ и 
%$\Pi_1 = \{ (\bar{\alpha}\alpha), (\alpha\bar{\alpha}), (\alpha\alpha) \}$

Комбинируя \ref{eq:svedenie} и \ref{eq:lemma_sm}, получаем следующую лемму:

\label{eq:main_lemma}
\textbf{Лемма.} Пусть $\pi(x_1, \dots, x_n) \notin SM$. Тогда, можно так выбрать $n-k$ переменных $\pi$, что,
$\pi_1 = ((\pi_{min} JOIN x_{i_{k+1}}=\alpha, \dots, x_{i_n}=\alpha) PROJECT x_{i_{k+1}}, x_{i_{k+2}}, \dots, x_{i_n})$,
$\Pi_1 = \{ Sch_{symm}^k \bigcup A \}$, где 
$A \subseteq P_2^k \backslash \{\Pi_{symm}^k \bigcup (\alpha, \alpha \dots, \alpha)\}$\footnote{
Множества всех кортежей без кортежей, присутствующих в симметричном шефферовом предикате и $(\alpha\alpha\dots\alpha)$}. 

\subsubsection{Доказательство планарности для случая $n = 3$}

\textbf{Алгоритм для случая 3 переменных}
\begin{itemize}
\item{Получаем отрицание и константы}
\item{Выделяем из полного базиса $\pi \notin SM$; применением PROJECT и NEGATE сводим к $\pi_{min}$,
 принадлежащему одному из 5 классов эквивалентности}
\item{В каждом из 5 классов, применением операций планарной суперпозиции, получаем предикат $\pi_{linear}$
\footnote{Например, сведением базисного предиката к $Sch_{symm}^3$}}
\item{Заменяем каждое реберное пересечение на 3 предиката $\pi_{linear}$}
\item{Результирующая схема является планарной}
\end{itemize}

\textbf{Доказательство.}
Выше было показано, как, не изменяя планарность схемы, получить константы и $\pi_{neg}$. 

По лемме \ref{eq:main_lemma}, из $\pi \notin SM$, применяя операции планарной суперпозиции, можно получить 
$\pi_1 = \pi_{min}, \Pi_1 = Sch_{symm}^3 \bigcup A$,
$ A \subseteq(\alpha \bar{\alpha} \alpha), (\alpha \alpha \bar{\alpha}), (\alpha \bar{\alpha} \alpha), (\alpha \alpha \alpha) \} $.

Таким образом, в зависимости от количества наборов, содержащихся в A, все несамодвойственные
предикаты от 3 переменных можно разбить на 5 классов эквивалентности:
\begin{itemize}
\item{Симметричный шефферов предикат $Sch_{symm}^3$}
\item{$Sch_{symm+1}^3$\footnote{Здесь и далее $Sch_{symm+i}^n$ будем обозначать предикат $\pi$, множество значений $\Pi$
которого представляет собой объединение кортежей симметричного шефферового предиката и какого-то подмножества 
$A = \{ (\bar{\alpha}, \bar{\alpha}, \dots, \alpha), \dots, (\alpha, \alpha, \dots, \alpha) \} $}}.

Заметим, что случай $\pi=Sch_{symm+1}^3$, где 
$\Pi = \{ (\alpha\bar{\alpha}\bar{\alpha}), (\bar{\alpha}\alpha\bar{\alpha}), (\bar{\alpha}\bar{\alpha}\alpha), (\alpha\alpha\alpha)\}$ 
не требует дополнительных преобразований и сведений, так как имеем планарную реализацию
$\pi_{linear}$, необходимую для планарного сведения по схеме \ref{fig:xor}
\item{$Sch_{symm+2}^3$}
\begin{figure}[htb]
\centering
\includegraphics[width=1.0\textwidth]{3_2to3.png}
\caption{Сведение $Sch_5^3$ к $Sch_{symm}^3$ }
\label{fig:3_2to3}
\end{figure}
\item{$Sch_{symm+3}^3$}
\begin{figure}[htb]
\centering
\includegraphics[width=1.0\textwidth]{3_3to3_2.png}
\caption{Сведение $Sch_{symm+3}^3$ к $Sch_{symm+2}^3$}
\label{fig:3_3to3_2}
\end{figure}
\item{$Sch_{symm+4}^3$}
\begin{figure}[htb]
\centering
\includegraphics[width=1.0\textwidth]{3_4to3_2.png}
\caption{Сведение $Sch_{symm+4}^3$ к $Sch_{symm+2}$}
\label{fig:3_4to3_2}
\end{figure}
\end{itemize}

Каждый из этих классов применением операций планарной суперпозиции сводится к 
симметричному Шефферовому базису, планарность которого была установлена в \ref{planar_basis}

\subsubsection{Случай $n > 3$}
По лемме \ref{eq:main_lemma}.
%В лемме \ref{eq:lemma_sm} было показано, что множество наборов всякого $\pi_{min} \notin SM$ содержит симметричный
%Шефферов предикат размерности $k$.

%Покажем, что в случае, если базис $B$ содержит $\pi \notin SM$, $\pi$ зависит от более чем 3 переменных, существует планарная
%сводимость $B$ к одному из симметричному шефферовому базису от 3 переменных, планарность которого была доказана ранее.

%\textbf{Лемма.} Пусть B~-- полный базис, $\pi^n \in B, \pi^n \notin SM$. Тогда $\exists \pi_1 = \pi_{min} NEGATE x_{i_1}, \dots x_{i_k}$, 
%$\pi_1 = Sch_{symm+t}^3$, где $t=\overline{0, 4}$.
%\textbf{Доказательство}. По лемме \ref{eq:main_lemma}

\begin{itemize}
\item Шефферов предикат $Sch_{symm}^4$ сводится к $Sch_{symm}^3$ по лемме 
\ref{eq:svedenie}, как показано на рисунке \ref{fig:4to3}
\begin{figure}[htb]
\centering
\includegraphics[width=0.6\textwidth]{4to3.png}
\caption{Сведение $Sch_4$ к $Sch_3$ }
\label{fig:4to3}
\end{figure}


\item $Sch_{symm+k}^4$ сводится к $Sch_{symm+t}^3$ применением операций $JOIN_2$ и PROJECT, как показано на рис.
\ref{fig:4_2to3_1}
\begin{figure}[htb]
\centering
\includegraphics[width=0.8\textwidth]{4_2to3_1.png}
\caption{Сведение $Sch_{symm+2}^4$сводится к $Sch_{symm+1}^3$}
\label{fig:4_2to3_1}
\end{figure}
\item $\ldots$
\item $Sch_{symm+k}^n$ сводится к $Sch_{symm+t}^{n-1}$i по лемме \ref{eq:main_lemma}.

\end{itemize}
%\subsubsection {Получение $\pi_3 \notin SM$}
%\textbf{Лемма}
%Пусть дан полный базис B. Покажем, что из $\pi_k \notin SM$, применением операций $JOIN_2$, SELECT, PROJECT, NEGATE
%можно получить $\pi_3 \notin SM$.
%\textbf{Доказательство} Следует из леммы \ref{eq:main_lemma} 


% Список цитируемой литературы
\clearpage
\addcontentsline{toc}{section}{Список цитируемой литературы}
\thebibliography{99}
\RBibitem{Shu09}
    \by М.~С.~Шуплецов
    \paper Оценки высокой степени точности для сложности предикатных схем в~некоторых базисах
    \inbook Физико-математические науки
    \serial Уч\"eн. зап. Казан. гос. ун-та. Сер. Физ.-матем. науки
    \yr 2009
    \vol 151
    \issue 2
    \pages 173--184
    \publ Изд-во Казанского ун-та
    \publaddr Казань
    \mathnet{http://mi.mathnet.ru/uzku760}

\bibitem{Shu11}Методы синтеза и оценки сложности схем, построенных из элементов предикатного типа, диссертация

\bibitem{CSP10} Handbook of Constraint Programming, ISBN 9780444527264; 2010 г.

\bibitem{Shaeffer78} Schaefer, Thomas J. (1978). 
``The Complexity of Satisfiability Problems''. STOC 1978. pp. 216–226. doi:10.1145/800133.804350.

\bibitem{Zarank54} Zarankiewicz, K. "On a Problem of P. Turán Concerning Graphs." Fund. Math. 41, 137-145, 1954. 

\bibitem{Prosc89} Arnborg, S.; Proskurowski, A. (1989), 
``Linear time algorithms for NP-hard problems restricted to partial k-trees'',
Discrete Applied Mathematics 23 (1): 11–24, doi:10.1016/0166-218X(89)90031-0.

\bibitem{Gott10} 
Georg Gottlob, Reinhard Pichler, and Fang Wei. 2010. Bounded treewidth as a key to tractability of knowledge representation and reasoning. Artif. Intell. 174, 1 (January 2010), 105-132. DOI=10.1016/j.artint.2009.10.003 http://dx.doi.org/10.1016/j.artint.2009.10.003

\bibitem{Diestel00}
Diestel, Reinhard (2000), Graph Theory, Graduate Texts in Mathematics, 
173, Springer-Verlag, ISBN 0-387-98976-5.

\bibitem{Boedlander96}
H. L. Bodlaender, A linear-time algorithm for finding 
tree-decompositions of small
treewidth, SIAM J. Comput. 25 (1996), 1305–1317


\endthebibliography

\end{document}
